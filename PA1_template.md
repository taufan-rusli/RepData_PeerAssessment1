# Reproducible Research Peer Assessment 1
==========================================

Chart plotting will be done using ggplot2

Import ggplot2 library

```r
library(ggplot2)
```

```
## Warning: package 'ggplot2' was built under R version 3.0.3
```


Import data and re-format date column from factor class to date class

```r
data <- read.csv("activity.csv")
data$date <- as.Date(data$date, "%Y-%m-%d")
```


Calculate mean and median total number of steps taken per day. Missing values are ignored.

```r
by(data$steps, data$date, mean, na.rm = TRUE)
```

```
## data$date: 2012-10-01
## [1] NaN
## -------------------------------------------------------- 
## data$date: 2012-10-02
## [1] 0.4375
## -------------------------------------------------------- 
## data$date: 2012-10-03
## [1] 39.42
## -------------------------------------------------------- 
## data$date: 2012-10-04
## [1] 42.07
## -------------------------------------------------------- 
## data$date: 2012-10-05
## [1] 46.16
## -------------------------------------------------------- 
## data$date: 2012-10-06
## [1] 53.54
## -------------------------------------------------------- 
## data$date: 2012-10-07
## [1] 38.25
## -------------------------------------------------------- 
## data$date: 2012-10-08
## [1] NaN
## -------------------------------------------------------- 
## data$date: 2012-10-09
## [1] 44.48
## -------------------------------------------------------- 
## data$date: 2012-10-10
## [1] 34.38
## -------------------------------------------------------- 
## data$date: 2012-10-11
## [1] 35.78
## -------------------------------------------------------- 
## data$date: 2012-10-12
## [1] 60.35
## -------------------------------------------------------- 
## data$date: 2012-10-13
## [1] 43.15
## -------------------------------------------------------- 
## data$date: 2012-10-14
## [1] 52.42
## -------------------------------------------------------- 
## data$date: 2012-10-15
## [1] 35.2
## -------------------------------------------------------- 
## data$date: 2012-10-16
## [1] 52.38
## -------------------------------------------------------- 
## data$date: 2012-10-17
## [1] 46.71
## -------------------------------------------------------- 
## data$date: 2012-10-18
## [1] 34.92
## -------------------------------------------------------- 
## data$date: 2012-10-19
## [1] 41.07
## -------------------------------------------------------- 
## data$date: 2012-10-20
## [1] 36.09
## -------------------------------------------------------- 
## data$date: 2012-10-21
## [1] 30.63
## -------------------------------------------------------- 
## data$date: 2012-10-22
## [1] 46.74
## -------------------------------------------------------- 
## data$date: 2012-10-23
## [1] 30.97
## -------------------------------------------------------- 
## data$date: 2012-10-24
## [1] 29.01
## -------------------------------------------------------- 
## data$date: 2012-10-25
## [1] 8.653
## -------------------------------------------------------- 
## data$date: 2012-10-26
## [1] 23.53
## -------------------------------------------------------- 
## data$date: 2012-10-27
## [1] 35.14
## -------------------------------------------------------- 
## data$date: 2012-10-28
## [1] 39.78
## -------------------------------------------------------- 
## data$date: 2012-10-29
## [1] 17.42
## -------------------------------------------------------- 
## data$date: 2012-10-30
## [1] 34.09
## -------------------------------------------------------- 
## data$date: 2012-10-31
## [1] 53.52
## -------------------------------------------------------- 
## data$date: 2012-11-01
## [1] NaN
## -------------------------------------------------------- 
## data$date: 2012-11-02
## [1] 36.81
## -------------------------------------------------------- 
## data$date: 2012-11-03
## [1] 36.7
## -------------------------------------------------------- 
## data$date: 2012-11-04
## [1] NaN
## -------------------------------------------------------- 
## data$date: 2012-11-05
## [1] 36.25
## -------------------------------------------------------- 
## data$date: 2012-11-06
## [1] 28.94
## -------------------------------------------------------- 
## data$date: 2012-11-07
## [1] 44.73
## -------------------------------------------------------- 
## data$date: 2012-11-08
## [1] 11.18
## -------------------------------------------------------- 
## data$date: 2012-11-09
## [1] NaN
## -------------------------------------------------------- 
## data$date: 2012-11-10
## [1] NaN
## -------------------------------------------------------- 
## data$date: 2012-11-11
## [1] 43.78
## -------------------------------------------------------- 
## data$date: 2012-11-12
## [1] 37.38
## -------------------------------------------------------- 
## data$date: 2012-11-13
## [1] 25.47
## -------------------------------------------------------- 
## data$date: 2012-11-14
## [1] NaN
## -------------------------------------------------------- 
## data$date: 2012-11-15
## [1] 0.1424
## -------------------------------------------------------- 
## data$date: 2012-11-16
## [1] 18.89
## -------------------------------------------------------- 
## data$date: 2012-11-17
## [1] 49.79
## -------------------------------------------------------- 
## data$date: 2012-11-18
## [1] 52.47
## -------------------------------------------------------- 
## data$date: 2012-11-19
## [1] 30.7
## -------------------------------------------------------- 
## data$date: 2012-11-20
## [1] 15.53
## -------------------------------------------------------- 
## data$date: 2012-11-21
## [1] 44.4
## -------------------------------------------------------- 
## data$date: 2012-11-22
## [1] 70.93
## -------------------------------------------------------- 
## data$date: 2012-11-23
## [1] 73.59
## -------------------------------------------------------- 
## data$date: 2012-11-24
## [1] 50.27
## -------------------------------------------------------- 
## data$date: 2012-11-25
## [1] 41.09
## -------------------------------------------------------- 
## data$date: 2012-11-26
## [1] 38.76
## -------------------------------------------------------- 
## data$date: 2012-11-27
## [1] 47.38
## -------------------------------------------------------- 
## data$date: 2012-11-28
## [1] 35.36
## -------------------------------------------------------- 
## data$date: 2012-11-29
## [1] 24.47
## -------------------------------------------------------- 
## data$date: 2012-11-30
## [1] NaN
```

```r
by(data$steps, data$date, median, na.rm = TRUE)
```

```
## data$date: 2012-10-01
## [1] NA
## -------------------------------------------------------- 
## data$date: 2012-10-02
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-03
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-04
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-05
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-06
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-07
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-08
## [1] NA
## -------------------------------------------------------- 
## data$date: 2012-10-09
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-10
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-11
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-12
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-13
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-14
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-15
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-16
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-17
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-18
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-19
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-20
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-21
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-22
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-23
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-24
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-25
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-26
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-27
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-28
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-29
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-30
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-31
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-01
## [1] NA
## -------------------------------------------------------- 
## data$date: 2012-11-02
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-03
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-04
## [1] NA
## -------------------------------------------------------- 
## data$date: 2012-11-05
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-06
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-07
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-08
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-09
## [1] NA
## -------------------------------------------------------- 
## data$date: 2012-11-10
## [1] NA
## -------------------------------------------------------- 
## data$date: 2012-11-11
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-12
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-13
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-14
## [1] NA
## -------------------------------------------------------- 
## data$date: 2012-11-15
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-16
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-17
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-18
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-19
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-20
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-21
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-22
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-23
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-24
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-25
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-26
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-27
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-28
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-29
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-30
## [1] NA
```


Create a data frame that contains average daily steps by interval and plot average daily steps vs interval

```r
stepInterval <- by(data$steps, data$interval, mean, na.rm = TRUE)
stepInterval <- data.frame(interval = as.numeric(names(stepInterval)), avgSteps = as.numeric(stepInterval))
ggplot(aes(x = interval, y = avgSteps), data = stepInterval) + geom_line() + scale_x_continuous(breaks = seq(0, 2500, 250))
```

![plot of chunk unnamed-chunk-4](figure/unnamed-chunk-4.png) 


Calculate the interval with highest average daily steps.
###The interval with the highest average daily steps is 835


```r
with(stepInterval, interval[which(avgSteps == max(avgSteps))])
```

```
## [1] 835
```


Calculate the number of NA rows in each column and since only steps column has NA values, the number of rows with NA is equal to the number of NA step observations, 2304 rows.


```r
naRows <- data.frame(steps = sum(is.na(data$steps)), date = sum(is.na(data$date)), interval = sum(is.na(data$interval)))
naRows
```

```
##   steps date interval
## 1  2304    0        0
```


Fill in NA steps observations with the mean steps of the same 5-minute interval


```r
naStepIndex <- which(is.na(data$steps))
naStepInterval <- data$interval[naStepIndex]
for (i in 1: length(naStepIndex)) {
    data$steps[naStepIndex[i]] <- stepInterval$avgSteps[stepInterval$interval == naStepInterval[i]]
}
```


Plot a histogram of total number of steps taken daily. The impact of imputing is higher total daily step count compared to just leaving NAs observation alone.


```r
ggplot(aes(x = date, weight = steps), data = data) + geom_histogram()
```

```
## stat_bin: binwidth defaulted to range/30. Use 'binwidth = x' to adjust this.
```

![plot of chunk unnamed-chunk-8](figure/unnamed-chunk-8.png) 


Calculate new mean and median of total number of steps.
###All the non valid average daily steps in the first part of assignment have been replaced with valid average daily steps.


```r
by(data$steps, data$date, mean)
```

```
## data$date: 2012-10-01
## [1] 37.38
## -------------------------------------------------------- 
## data$date: 2012-10-02
## [1] 0.4375
## -------------------------------------------------------- 
## data$date: 2012-10-03
## [1] 39.42
## -------------------------------------------------------- 
## data$date: 2012-10-04
## [1] 42.07
## -------------------------------------------------------- 
## data$date: 2012-10-05
## [1] 46.16
## -------------------------------------------------------- 
## data$date: 2012-10-06
## [1] 53.54
## -------------------------------------------------------- 
## data$date: 2012-10-07
## [1] 38.25
## -------------------------------------------------------- 
## data$date: 2012-10-08
## [1] 37.38
## -------------------------------------------------------- 
## data$date: 2012-10-09
## [1] 44.48
## -------------------------------------------------------- 
## data$date: 2012-10-10
## [1] 34.38
## -------------------------------------------------------- 
## data$date: 2012-10-11
## [1] 35.78
## -------------------------------------------------------- 
## data$date: 2012-10-12
## [1] 60.35
## -------------------------------------------------------- 
## data$date: 2012-10-13
## [1] 43.15
## -------------------------------------------------------- 
## data$date: 2012-10-14
## [1] 52.42
## -------------------------------------------------------- 
## data$date: 2012-10-15
## [1] 35.2
## -------------------------------------------------------- 
## data$date: 2012-10-16
## [1] 52.38
## -------------------------------------------------------- 
## data$date: 2012-10-17
## [1] 46.71
## -------------------------------------------------------- 
## data$date: 2012-10-18
## [1] 34.92
## -------------------------------------------------------- 
## data$date: 2012-10-19
## [1] 41.07
## -------------------------------------------------------- 
## data$date: 2012-10-20
## [1] 36.09
## -------------------------------------------------------- 
## data$date: 2012-10-21
## [1] 30.63
## -------------------------------------------------------- 
## data$date: 2012-10-22
## [1] 46.74
## -------------------------------------------------------- 
## data$date: 2012-10-23
## [1] 30.97
## -------------------------------------------------------- 
## data$date: 2012-10-24
## [1] 29.01
## -------------------------------------------------------- 
## data$date: 2012-10-25
## [1] 8.653
## -------------------------------------------------------- 
## data$date: 2012-10-26
## [1] 23.53
## -------------------------------------------------------- 
## data$date: 2012-10-27
## [1] 35.14
## -------------------------------------------------------- 
## data$date: 2012-10-28
## [1] 39.78
## -------------------------------------------------------- 
## data$date: 2012-10-29
## [1] 17.42
## -------------------------------------------------------- 
## data$date: 2012-10-30
## [1] 34.09
## -------------------------------------------------------- 
## data$date: 2012-10-31
## [1] 53.52
## -------------------------------------------------------- 
## data$date: 2012-11-01
## [1] 37.38
## -------------------------------------------------------- 
## data$date: 2012-11-02
## [1] 36.81
## -------------------------------------------------------- 
## data$date: 2012-11-03
## [1] 36.7
## -------------------------------------------------------- 
## data$date: 2012-11-04
## [1] 37.38
## -------------------------------------------------------- 
## data$date: 2012-11-05
## [1] 36.25
## -------------------------------------------------------- 
## data$date: 2012-11-06
## [1] 28.94
## -------------------------------------------------------- 
## data$date: 2012-11-07
## [1] 44.73
## -------------------------------------------------------- 
## data$date: 2012-11-08
## [1] 11.18
## -------------------------------------------------------- 
## data$date: 2012-11-09
## [1] 37.38
## -------------------------------------------------------- 
## data$date: 2012-11-10
## [1] 37.38
## -------------------------------------------------------- 
## data$date: 2012-11-11
## [1] 43.78
## -------------------------------------------------------- 
## data$date: 2012-11-12
## [1] 37.38
## -------------------------------------------------------- 
## data$date: 2012-11-13
## [1] 25.47
## -------------------------------------------------------- 
## data$date: 2012-11-14
## [1] 37.38
## -------------------------------------------------------- 
## data$date: 2012-11-15
## [1] 0.1424
## -------------------------------------------------------- 
## data$date: 2012-11-16
## [1] 18.89
## -------------------------------------------------------- 
## data$date: 2012-11-17
## [1] 49.79
## -------------------------------------------------------- 
## data$date: 2012-11-18
## [1] 52.47
## -------------------------------------------------------- 
## data$date: 2012-11-19
## [1] 30.7
## -------------------------------------------------------- 
## data$date: 2012-11-20
## [1] 15.53
## -------------------------------------------------------- 
## data$date: 2012-11-21
## [1] 44.4
## -------------------------------------------------------- 
## data$date: 2012-11-22
## [1] 70.93
## -------------------------------------------------------- 
## data$date: 2012-11-23
## [1] 73.59
## -------------------------------------------------------- 
## data$date: 2012-11-24
## [1] 50.27
## -------------------------------------------------------- 
## data$date: 2012-11-25
## [1] 41.09
## -------------------------------------------------------- 
## data$date: 2012-11-26
## [1] 38.76
## -------------------------------------------------------- 
## data$date: 2012-11-27
## [1] 47.38
## -------------------------------------------------------- 
## data$date: 2012-11-28
## [1] 35.36
## -------------------------------------------------------- 
## data$date: 2012-11-29
## [1] 24.47
## -------------------------------------------------------- 
## data$date: 2012-11-30
## [1] 37.38
```

```r
by(data$steps, data$date, median)
```

```
## data$date: 2012-10-01
## [1] 34.11
## -------------------------------------------------------- 
## data$date: 2012-10-02
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-03
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-04
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-05
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-06
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-07
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-08
## [1] 34.11
## -------------------------------------------------------- 
## data$date: 2012-10-09
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-10
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-11
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-12
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-13
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-14
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-15
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-16
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-17
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-18
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-19
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-20
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-21
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-22
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-23
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-24
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-25
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-26
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-27
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-28
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-29
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-30
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-10-31
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-01
## [1] 34.11
## -------------------------------------------------------- 
## data$date: 2012-11-02
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-03
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-04
## [1] 34.11
## -------------------------------------------------------- 
## data$date: 2012-11-05
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-06
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-07
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-08
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-09
## [1] 34.11
## -------------------------------------------------------- 
## data$date: 2012-11-10
## [1] 34.11
## -------------------------------------------------------- 
## data$date: 2012-11-11
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-12
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-13
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-14
## [1] 34.11
## -------------------------------------------------------- 
## data$date: 2012-11-15
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-16
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-17
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-18
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-19
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-20
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-21
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-22
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-23
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-24
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-25
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-26
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-27
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-28
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-29
## [1] 0
## -------------------------------------------------------- 
## data$date: 2012-11-30
## [1] 34.11
```

Create a new factor variable to indicate "weekday" vs "weekend"


```r
data$dayType <- ifelse(weekdays(data$date) == "Saturday" | weekdays(data$date) == "Sunday", "Weekend", "Weekday")
```

Create time series average daily steps vs interval separated by weekend or weekday


```r
weekdayData <- data[data$dayType == "Weekday", ]
weekendData <- data[data$dayType == "Weekend", ]
weekendStepInterval <- by(weekendData$steps, weekendData$interval, mean)
weekendStepInterval <- data.frame(interval = as.numeric(names(weekendStepInterval)), avgSteps = as.numeric(weekendStepInterval))
weekdayStepInterval <- by(weekdayData$steps, weekdayData$interval, mean)
weekdayStepInterval <- data.frame(interval = as.numeric(names(weekdayStepInterval)), avgSteps = as.numeric(weekdayStepInterval))
weekendStepInterval$dayType <- "Weekend"
weekdayStepInterval$dayType <- "weekday"
wholeWeekStepInterval <- rbind(weekendStepInterval, weekdayStepInterval)
ggplot(aes(x = interval, y = avgSteps), data = wholeWeekStepInterval) + geom_line() + facet_wrap(~dayType, ncol = 1)
```

![plot of chunk unnamed-chunk-11](figure/unnamed-chunk-11.png) 

